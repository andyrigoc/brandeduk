<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrandedUK</title>
    <style>
        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background: #f7f7f7;
            color: #333;
        }
        .loader-container {
            text-align: center;
            padding: 20px;
        }
        
        /* Dots Animation */
        .dots-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }
        .dots-container .dot {
            height: 20px;
            width: 20px;
            margin-right: 10px;
            border-radius: 10px;
            background-color: #c4b5fd;
            animation: pulse 1.5s infinite ease-in-out;
        }
        .dots-container .dot:last-child {
            margin-right: 0;
        }
        .dots-container .dot:nth-child(1) { animation-delay: -0.3s; }
        .dots-container .dot:nth-child(2) { animation-delay: -0.1s; }
        .dots-container .dot:nth-child(3) { animation-delay: 0.1s; }
        .dots-container .dot:nth-child(4) { animation-delay: 0.3s; }
        .dots-container .dot:nth-child(5) { animation-delay: 0.5s; }
        
        @keyframes pulse {
            0% {
                transform: scale(0.8);
                background-color: #c4b5fd;
                box-shadow: 0 0 0 0 rgba(167, 139, 250, 0.7);
            }
            50% {
                transform: scale(1.2);
                background-color: #7c3aed;
                box-shadow: 0 0 0 10px rgba(167, 139, 250, 0);
            }
            100% {
                transform: scale(0.8);
                background-color: #c4b5fd;
                box-shadow: 0 0 0 0 rgba(167, 139, 250, 0.7);
            }
        }
        
        a { color: #7c3aed; text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="loader-container">
        <section class="dots-container">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </section>
        <p>Loading…</p>
        <p id="debugInfo" style="font-size:12px; color:#666; margin:6px 0 10px;"></p>
        <p style="margin:0; font-size:13px;">
            <a href="index-mobile.html" id="mobileLink">Mobile/Tablet</a>
            &nbsp;|&nbsp;
            <a href="home-pc.html" id="desktopLink">Desktop</a>
        </p>
        <noscript>
            <p>
                JavaScript is required for automatic redirect.<br>
                <a href="index-mobile.html">Go to Mobile/Tablet Site</a> | 
                <a href="home-pc.html">Go to Desktop Site</a>
            </p>
        </noscript>
    </div>

    <script>
        (function () {
            var BREAKPOINT = 1024;
            var lastTarget = null;
            var autoTimer = null;
            var debugInfoEl = document.getElementById('debugInfo');
            var redirected = false;

            function loadTawkIfAllowed() {
                try {
                    var host = window.location.hostname;
                    if (host === 'localhost' || host === '127.0.0.1') {
                        return Promise.resolve({ skipped: true });
                    }
                } catch (e) {
                    // If we can't read hostname for some reason, don't block redirect.
                    return Promise.resolve({ skipped: true });
                }

                return new Promise(function (resolve) {
                    try {
                        window.Tawk_API = window.Tawk_API || {};
                        window.Tawk_LoadStart = new Date();

                        var s1 = document.createElement('script');
                        var s0 = document.getElementsByTagName('script')[0];
                        s1.async = true;
                        s1.src = 'https://embed.tawk.to/69628dafb346e51985794182/1jekfitse';
                        s1.charset = 'UTF-8';
                        s1.setAttribute('crossorigin', '*');
                        s1.onload = function () { resolve({ loaded: true }); };
                        s1.onerror = function () { resolve({ loaded: false }); };
                        s0.parentNode.insertBefore(s1, s0);
                    } catch (e) {
                        resolve({ loaded: false });
                    }
                });
            }

            function updateDebug(mode) {
                if (!debugInfoEl) return;
                debugInfoEl.textContent = 'width=' + window.innerWidth + ' • dpr=' + (window.devicePixelRatio || 1) + ' • mode=' + mode;
            }

            function getForcedTarget() {
                try {
                    var params = new URLSearchParams(window.location.search);
                    var force = (params.get('force') || '').toLowerCase();
                    if (force === 'mobile') return 'index-mobile.html';
                    if (force === 'desktop') return 'home-pc.html';
                } catch (e) {}
                return null;
            }

            function computeTargetByDevice() {
                var ua = (navigator.userAgent || '').toLowerCase();
                var uaDataMobile = false;
                try {
                    uaDataMobile = !!(navigator.userAgentData && navigator.userAgentData.mobile);
                } catch (e) {
                    uaDataMobile = false;
                }
                var isIPad = ua.indexOf('ipad') !== -1 || (ua.indexOf('macintosh') !== -1 && (navigator.maxTouchPoints || 0) > 1);
                var isIPhone = ua.indexOf('iphone') !== -1 || ua.indexOf('ipod') !== -1;
                var isAndroid = ua.indexOf('android') !== -1;
                var isAndroidTablet = isAndroid && ua.indexOf('mobile') === -1;
                var isTabletUA = isIPad || isAndroidTablet || ua.indexOf('tablet') !== -1 || ua.indexOf('silk') !== -1;
                var isMobileUA = uaDataMobile || isIPhone || /\bmobi\b/.test(ua) || ua.indexOf('iemobile') !== -1 || ua.indexOf('opera mini') !== -1;
                var isViewportMobile = window.matchMedia
                    ? window.matchMedia('(max-width: ' + (BREAKPOINT - 1) + 'px)').matches
                    : (window.innerWidth < BREAKPOINT);
                var shouldUseMobile = isMobileUA || isTabletUA || isViewportMobile;
                return shouldUseMobile ? 'index-mobile.html' : 'home-pc.html';
            }

            function redirectIfNeeded() {
                if (redirected) return;
                var forced = getForcedTarget();
                var target = forced || computeTargetByDevice();
                updateDebug(forced ? ('forced:' + forced) : (target.indexOf('mobile') !== -1 ? 'auto:mobile' : 'auto:desktop'));
                if (target) {
                    redirected = true;
                    lastTarget = target;
                    window.location.replace(target);
                }
            }

            // Load Tawk quickly (online only), then redirect.
            // This prevents the redirect from cutting off the network request immediately.
            updateDebug('pending');

            var MAX_WAIT_MS = 700;
            var didRedirect = false;

            function safeRedirect(reason) {
                if (didRedirect) return;
                didRedirect = true;
                updateDebug(reason);
                redirectIfNeeded();
            }

            // Timeout always wins to keep UX snappy.
            autoTimer = setTimeout(function () {
                safeRedirect('timeout');
            }, MAX_WAIT_MS);

            // Start as early as possible; if DOM isn't ready yet, just wait for it.
            var start = function () {
                loadTawkIfAllowed().then(function (result) {
                    // Redirect immediately after we at least start/finish loading.
                    // We still keep the timeout as a safety net.
                    if (result && result.skipped) return safeRedirect('skip:localhost');
                    return safeRedirect('tawk');
                });
            };

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', start);
            } else {
                start();
            }
        })();
    </script>
</body>
</html>
